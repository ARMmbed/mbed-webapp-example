<!DOCTYPE html>
<!--
  ~ Copyright (c) 2015, ARM Limited, All Rights Reserved
  ~ SPDX-License-Identifier: Apache-2.0
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License"); you may
  ~ not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  ~ WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>ARM</title>
    <!-- Optional Bootstrap Theme -->
    <link href="data:text/css;charset=utf-8," data-href="css/bootstrap-theme.min.css" rel="stylesheet" id="bs-theme-stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="css/Custom.css" rel="stylesheet">
</head>

<body>
    <div ng-app="App" ng-controller="Ctrl">
        <!-- Fixed navbar -->
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand myLogo" href="#">
                        <img src="Images/mbed-logo.png" />
                    </a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="Devices.html">Devices</a></li>
                        <li><a href="Configuration.html">Configuration</a></li>

                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#">Default</a></li>
                        <li><a href="#">Static top</a></li>
                        <li class="active"><a href="#">Fixed top <span class="sr-only">(current)</span></a></li>
                    </ul>
                </div>
                <!--/.nav-collapse -->
            </div>
        </nav>
        <div class="container">

            <!-- Main component for a primary marketing message or call to action -->
            <div class="jumbotron">
                <ul id="myTab" class="nav nav-tabs">
                    <li class="active"><a href="#server" data-toggle="tab">Server</a></li>
                    <li class=""><a href="#subscription" data-toggle="tab">Pre-Subscription</a></li>
                </ul>
                <div id="myTabContent" class="tab-content">
                     <div class="tab-pane fade active in" id="server" style="margin-top:15px">
                   <form class="form-horizontal">
                                <div class="form-group">
                                    <label for="address" class="col-sm-3 control-label">Device server address</label>
                                    <div class="col-sm-9">
                                        <input type="url" class="form-control" id="address" placeholder="Address" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="username" class="col-sm-3 control-label">Username</label>
                                    <div class="col-sm-9">
                                        <input type="text" class="form-control" id="username" placeholder="Username" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="password" class="col-sm-3 control-label">Password</label>
                                    <div class="col-sm-9">
                                        <input type="password" class="form-control" id="password" placeholder="Password" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="rePass" class="col-sm-3 control-label">Re-type password</label>
                                    <div class="col-sm-9">
                                        <input type="password" class="form-control" id="rePass" placeholder="Re-type password" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-offset-3 col-sm-9">
                                        <button type="submit" class="btn btn-info btn-custom">Save</button>
                                    </div>
                                </div>
                            </form>
                  </div>
                  <div class="tab-pane fade" id="subscription" style="margin-top:15px">
                                    <div class="input-group">
                    <input type="text" class="form-control" ng-model="searchText" placeholder="Search for...">
                    <span class="input-group-btn">
                            <button class="btn btn-default btn-info" type="button">Search
                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                    </span>
                </div>
                <!-- /input-group -->
                <div class="table-responsive">
                    <table class="table table-bordered table-striped table-hover" >
                    <thead class="list-group-item-info">
                        <tr>
                            <th>Pre-Subscription</th>
                            <th class="td_center">Delete</th>
                        </tr>
                    </thead>
                        <tfoot> <tr><td colspan="2">
                                    <button class="btn btn-success btn-custom">Push</button>
                                    </td></tr></tfoot>
                    <tbody>
                         <tr ng-repeat="x in subscription | filter:searchText">
                             <td class="col-md-10"> <a href="#" ng-click="update(x.Name,$index)">{{x.Name}}</a></td>
                             <td class="col-md-1 td_center">
                                <span class="btn btn-danger btn-xs" ng-click="delete($index)">Delete</span></td>
                        </tr>
                    </tbody>
                </table>
                     
                </div>
                      
                <div>
                    <div style="margin-bottom:10px">
                        <div class="input-group">

                            <span class="input-group-btn">
                            <button class="btn btn-default btn-select" ng-class="{'btn btn-default':endpoint_name.state == 'One','btn btn-info':endpoint_name.state == 'Two'}" 
                                    ng-model="endpoint_name" ng-click="active()" type="button">Endpoint name
                                <span  aria-hidden="true"></span>
                            </button>
                            </span>
                            <input type="text" ng-model="txt_name" class="form-control">
                        </div>
                         <div class="input-group">

                            <span class="input-group-btn">

                            <button class="btn btn-default btn-select" ng-class="{'btn btn-default':endpoint_type.state == 'One','btn btn-info':endpoint_type.state == 'Two'}" 
                                    ng-model="endpoint_type" ng-click="active_type()" type="button">Endpoint type
                                <span aria-hidden="true"></span>
                            </button>
                            </span>
                            <input type="text" ng-model="txt_type" class="form-control">
                        </div>
                        <div class="input-group">

                            <span class="input-group-btn">

                            <button class="btn btn-default btn-select" ng-class="{'btn btn-default':endpoint_path.state == 'One','btn btn-info':endpoint_path.state == 'Two'}" 
                                    ng-model="endpoint_path" ng-click="active_path()" type="button">Resource path
                                <span aria-hidden="true" ></span>
                            </button>
                            </span>
                            <input type="text" ng-model="txt_path" class="form-control">
                        </div>
                       
                    </div>
                    <div style="margin-top:10px">
                                    <button ng-click="addRow()" class="btn btn-info btn-custom">{{btn_text}}</button>
                                    <button ng-hide="show_close" class="btn btn-danger btn-custom" ng-click="refresh()">Close</button>
                                    </div>
                </div>
                  </div>
                </div>
<!--                <h2>Configuration</h2>-->
                <!-- input-group -->



            </div>
            <!-- /container -->

            <!-- Bootstrap core JavaScript
================================================== -->
            <!-- Placed at the end of the document so the pages load faster -->
           
            <script>
                var app = angular.module('App', []);
                app.controller('Ctrl', function($scope) {
                    $scope.show_close = true;
                    $scope.btn_text = 'add';
                    $scope.subscription = [{"Name":"endpoint-name: 'node-001',resource-path: ['/dev']"}
                                           ,{"Name":"endpoint-type: 'Light',resource-path: ['/sen/*']"}
                                  ,{"Name":"resource-path: ['/dev/temp','/dev/hum']"}];
                    $scope.states = ['One', 'Two'];
                    $scope.endpoint_name = {
                        state: $scope.states[0]
                    };
                    $scope.endpoint_type = {
                        state: $scope.states[0]
                    };
                    $scope.endpoint_path = {
                        state: $scope.states[0]
                    };
                    var i = 1;
                    var j = 1;
                    var k = 1;
                    $scope.active = function() {
                        $scope.endpoint_name.state = $scope.states[i % 2];
                        i++;
                    };
                    $scope.active_type = function() {
                        $scope.endpoint_type.state = $scope.states[j % 2];
                        j++;
                    };
                    $scope.active_path = function() {
                        $scope.endpoint_path.state = $scope.states[k % 2];
                        k++;
                    };
                    $scope.addRow = function(){
                        var pre_subscription = '';
                        if($scope.txt_name != 'undefined' && $scope.txt_name != null && $scope.txt_name != '')
                            pre_subscription += 'endpoint-name:' + $scope.txt_name + ',';
                        
                        if($scope.txt_type != 'undefined' && $scope.txt_type != null && $scope.txt_type != '')
                            pre_subscription += 'endpoint-type:' + $scope.txt_type + ',';
                            
                        if($scope.txt_path != 'undefined' && $scope.txt_path != null && $scope.txt_path != '')
                            pre_subscription += 'resource-path:' + $scope.txt_path + ',';
                        
                        if(pre_subscription != '')
                        {
                            if(update_indext != -1)
                            {
                                $scope.subscription.splice( update_indext, 1 );
                            }
                            pre_subscription = pre_subscription.substring(0, pre_subscription.length - 1);
                            $scope.subscription.push({ 'Name': pre_subscription});
                        }
                        $scope.refresh();
                    };
                    var update_indext =-1;
                    $scope.update = function(text,row_number){
                        $scope.refresh();
                        var pre_subscription = text.split(',');
                        for(item in pre_subscription)
                        {
                            if(pre_subscription[item].startsWith("endpoint-name"))
                                $scope.txt_name = pre_subscription[item].substring(14,pre_subscription[item].length);
                            else if(pre_subscription[item].startsWith("endpoint-type"))
                                $scope.txt_type= pre_subscription[item].substring(14,pre_subscription[item].length);
                            else if(pre_subscription[item].startsWith("resource-path"))
                                $scope.txt_path= pre_subscription[item].substring(14,pre_subscription[item].length);
                            else // because it is possible that we have commas in the path too
                            {
                                $scope.txt_path += "," + pre_subscription[item];
                            }
                        }
                        update_indext = row_number;
                        $scope.show_close = false;
                        $scope.btn_text = 'Update';

                    };
                    $scope.refresh = function(){
                        $scope.txt_name = '';
                        $scope.txt_type = '';
                        $scope.txt_path = '';
                        update_indext = -1;
                        $scope.show_close = true;
                        $scope.btn_text = 'Add';
                    };
                    $scope.delete = function(row_number){
                        $scope.subscription.splice( row_number, 1 );
                        $scope.refresh();
                    };
                });
            </script>
            <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
            <script src="js/bootstrap.min.js"></script>
        </div>
         </div>
</body>

</html>